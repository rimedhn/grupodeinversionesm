<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <style type="text/css">
        body { font-family: Arial, sans-serif; font-size: 10px; margin: 0; padding: 0; }
        .page {
            width: 8.5in;
            min-height: 11in;
            padding: 0.3in;
            margin: auto;
            background: white;
            page-break-after: always;
        }
        table { width: 100%; border-collapse: collapse; margin-bottom: 8px; table-layout: fixed; }
        th, td { border: 1px solid black; padding: 4px; overflow: hidden; word-wrap: break-word; }
        .section-title { background-color: #f0f0f0; text-align: center; font-weight: bold; text-transform: uppercase; font-size: 11px; }
        .label { font-weight: bold; font-size: 9px; }
        .no-border { border: none !important; }
        .mi-logo { width: 70px; height: 70px; }
        .signature-container { display: flex; justify-content: space-around; margin-top: 30px; text-align: center; }
        .sig-box { width: 30%; border-top: 1px solid black; padding-top: 5px; }
        h1 { margin: 0; font-size: 18px; }
        
        /* Estilo para tablas financieras dinámicas */
        .fin-table td { vertical-align: top; border: 1px solid black; }
        .item-row { display: flex; justify-content: space-between; border-bottom: 0.5px solid #eee; padding: 2px 0; }
    </style>
</head>
<body>

<div class="page" id="page1">
    <table class="no-border">
        <tr>
            <td class="no-border" style="width: 15%;"><img src="https://github.com/rimedhn/servicredith/blob/main/servicredith%20logo.jpeg?raw=true" class="mi-logo" /></td>
            <td class="no-border" style="text-align: center;">
                <h1>SOLICITUD DE CRÉDITO</h1>
                <h2 style="margin:0">SERFIN</h2>
            </td>
            <td class="no-border" style="width: 20%; text-align: right;"><b>Fecha:</b> <span class="date-val"></span></td>
        </tr>
    </table>

    <table id="datos-generales-cliente">
        <tr>
            <td colspan="3"><span class="label">Nombre completo:</span> <span id="c_nombre"></span></td>
            <td><span class="label"># DNI:</span> <span id="c_dni"></span></td>
        </tr>
        <tr>
            <td><span class="label">Estado civil:</span> <span id="c_civil"></span></td>
            <td><span class="label">Ciclo:</span> <span id="c_ciclo"></span></td>
            <td><span class="label">Ocupación:</span> <span id="c_ocupacion"></span></td>
            <td><span class="label">Edad:</span> <span id="c_edad"></span></td>
        </tr>
        <tr>
            <td><span class="label">Sexo:</span> <span id="c_sexo"></span></td>
            <td><span class="label">Celular:</span> <span id="c_cel"></span></td>
            <td><span class="label">Monto:</span> L. <span id="c_monto"></span></td>
            <td><span class="label">Plazo:</span> <span id="c_plazo"></span></td>
        </tr>
        <tr>
            <td colspan="2"><span class="label">Destino:</span> <span id="c_destino"></span></td>
            <td><span class="label">Frecuencia:</span> <span id="c_frecuencia"></span></td>
            <td><span class="label">Cuota:</span> L. <span id="c_cuota"></span></td>
        </tr>
    </table>

    <div class="section-title">Información Financiera Dinámica</div>
    <table class="fin-table">
        <thead>
            <tr class="section-title">
                <th>ACTIVOS</th>
                <th>INGRESOS</th>
                <th>EGRESOS</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td id="c_list_activos"></td>
                <td id="c_list_ingresos"></td>
                <td id="c_list_egresos"></td>
            </tr>
            <tr style="font-weight: bold; background: #fafafa;">
                <td>Total Activos: L. <span id="c_total_act"></span></td>
                <td>Total Ingresos: L. <span id="c_total_ing"></span></td>
                <td>Total Egresos: L. <span id="c_total_egr"></span></td>
            </tr>
        </tbody>
    </table>
    <div style="text-align: right; font-weight: bold; padding: 5px; font-size: 12px;">
        DISPONIBILIDAD: L. <span id="c_dispo"></span>
    </div>

    <div class="section-title">Asalariados</div>
    <table id="c_asalariado_table">
        <tr>
            <td><span class="label">Empresa:</span> <span id="c_empresa_t"></span></td>
            <td><span class="label">Jefe:</span> <span id="c_jefe"></span></td>
            <td><span class="label">Teléfono:</span> <span id="c_tel_t"></span></td>
        </tr>
    </table>

    <div class="signature-container">
        <div class="sig-box">Firma Cliente</div>
        <div class="sig-box">Asesor de Crédito</div>
        <div class="sig-box">Autorizado SERFIN</div>
    </div>
</div>

<div class="page" id="page2">
    <table class="no-border">
        <tr>
            <td class="no-border" style="width: 15%;"><img src="https://github.com/rimedhn/servicredith/blob/main/servicredith%20logo.jpeg?raw=true" class="mi-logo" /></td>
            <td class="no-border" style="text-align: center;">
                <h1>FICHA DE AVAL</h1>
                <h2 style="margin:0">SERFIN</h2>
            </td>
            <td class="no-border" style="width: 20%; text-align: right;"><b>Fecha:</b> <span class="date-val"></span></td>
        </tr>
    </table>

    <table>
        <tr>
            <td colspan="3"><span class="label">Nombre Aval:</span> <span id="a_nombre"></span></td>
            <td><span class="label"># DNI:</span> <span id="a_dni"></span></td>
        </tr>
        <tr>
            <td><span class="label">Parentesco:</span> <span id="a_parentesco"></span></td>
            <td><span class="label">Celular:</span> <span id="a_cel"></span></td>
            <td colspan="2"><span class="label">Dirección:</span> <span id="a_direccion"></span></td>
        </tr>
    </table>

    <div class="section-title">Información Financiera del Aval</div>
    <table class="fin-table">
        <thead>
            <tr class="section-title">
                <th>ACTIVOS</th>
                <th>INGRESOS</th>
                <th>EGRESOS</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td id="a_list_activos"></td>
                <td id="a_list_ingresos"></td>
                <td id="a_list_egresos"></td>
            </tr>
            <tr style="font-weight: bold; background: #fafafa;">
                <td>Total Activos: L. <span id="a_total_act"></span></td>
                <td>Total Ingresos: L. <span id="a_total_ing"></span></td>
                <td>Total Egresos: L. <span id="a_total_egr"></span></td>
            </tr>
        </tbody>
    </table>

    <div class="signature-container" style="margin-top: 100px;">
        <div class="sig-box">Firma de Aval</div>
        <div class="sig-box">Asesor de Créditos</div>
        <div class="sig-box">Sello SERFIN</div>
    </div>
</div>

<script>
    function getParam(p) {
        return new URLSearchParams(window.location.search).get(p) || "";
    }

    function buildFinList(containerId, namesStr, valuesStr) {
        const container = document.getElementById(containerId);
        if (!namesStr) return;
        
        const names = namesStr.split(",");
        const values = valuesStr.split(",");
        
        let html = "";
        names.forEach((name, i) => {
            html += `<div class="item-row">
                        <span>${name.trim()}</span>
                        <span>L. ${values[i] ? values[i].trim() : "0.00"}</span>
                     </div>`;
        });
        container.innerHTML = html;
    }

    function fillAll() {
        // Datos Cliente [cite: 2]
        const c_map = {
            "c_nombre": "nombre_c", "c_dni": "dni_c", "c_civil": "civil_c",
            "c_ciclo": "ciclo_c", "c_ocupacion": "ocupacion_c", "c_edad": "edad_c",
            "c_sexo": "sexo_c", "c_cel": "cel_c", "c_monto": "monto",
            "c_plazo": "plazo", "c_destino": "destino", "c_frecuencia": "frecuencia",
            "c_cuota": "cuota", "c_empresa_t": "empresa_t", "c_jefe": "jefe_t",
            "c_tel_t": "tel_t", "c_total_act": "total_act_c", "c_total_ing": "total_ing_c",
            "c_total_egr": "total_egr_c", "c_dispo": "dispo_c"
        };

        // Datos Aval [cite: 79, 80]
        const a_map = {
            "a_nombre": "nombre_a", "a_dni": "dni_a", "a_parentesco": "parent_a",
            "a_cel": "cel_a", "a_direccion": "dir_a", "a_total_act": "total_act_a",
            "a_total_ing": "total_ing_a", "a_total_egr": "total_egr_a"
        };

        Object.keys(c_map).forEach(id => document.getElementById(id).textContent = getParam(c_map[id]));
        Object.keys(a_map).forEach(id => document.getElementById(id).textContent = getParam(a_map[id]));
        
        // Fecha para ambas hojas [cite: 2, 86]
        const hoy = getParam("fecha") || new Date().toLocaleDateString();
        document.querySelectorAll(".date-val").forEach(el => el.textContent = hoy);

        // Lógica Dinámica Financiera (Arrays separados por comas) [cite: 5, 107]
        // Cliente
        buildFinList("c_list_activos", getParam("c_act_nombres"), getParam("c_act_valores"));
        buildFinList("c_list_ingresos", getParam("c_ing_nombres"), getParam("c_ing_valores"));
        buildFinList("c_list_egresos", getParam("c_egr_nombres"), getParam("c_egr_valores"));
        
        // Aval
        buildFinList("a_list_activos", getParam("a_act_nombres"), getParam("a_act_valores"));
        buildFinList("a_list_ingresos", getParam("a_ing_nombres"), getParam("a_ing_valores"));
        buildFinList("a_list_egresos", getParam("a_egr_nombres"), getParam("a_egr_valores"));
    }

    window.onload = () => {
        fillAll();
        // window.print(); // Activa para imprimir automáticamente
    };
</script>
</body>
</html>
