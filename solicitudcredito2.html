<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <style type="text/css">
        body { font-family: Arial, sans-serif; font-size: 9px; margin: 0; padding: 0; }
        .page {
            width: 8.5in;
            min-height: 11in;
            padding: 0.4in;
            margin: auto;
            background: white;
            page-break-after: always;
        }
        table { width: 100%; border-collapse: collapse; margin-bottom: 5px; table-layout: fixed; }
        th, td { border: 1px solid black; padding: 3px; vertical-align: top; overflow: hidden; }
        .header-title { text-align: center; font-weight: bold; font-size: 16px; margin: 0; }
        .section-title { background-color: #e0e0e0; text-align: center; font-weight: bold; text-transform: uppercase; padding: 2px; border: 1px solid black; }
        .label { font-weight: bold; font-size: 8.5px; display: block; }
        .no-border { border: none !important; }
        .mi-logo { width: 65px; height: 65px; }
        .check-box { display: inline-block; width: 10px; height: 10px; border: 1px solid black; margin-right: 2px; text-align: center; line-height: 10px; font-size: 8px; }
        .footer-sig { margin-top: 20px; display: flex; justify-content: space-around; text-align: center; }
        .sig-line { border-top: 1px solid black; width: 180px; margin-top: 40px; padding-top: 5px; }
    </style>
</head>
<body>

<div class="page">
    <table class="no-border">
        <tr>
            <td class="no-border" style="width: 15%;"><img src="https://github.com/rimedhn/servicredith/blob/main/servicredith%20logo.jpeg?raw=true" class="mi-logo" /></td>
            <td class="no-border" style="text-align: center;">
                <h1 class="header-title">SOLICITUD DE CRÉDITO</h1>
                <div style="font-weight: bold; font-size: 14px;">SERFIN</div>
            </td>
            <td class="no-border" style="width: 15%; text-align: right;">
                <span class="label">Fecha:</span> <span id="fecha_p1"></span>
            </td>
        </tr>
    </table>

    <table>
        <tr>
            <td colspan="2"><span class="label">Nombre completo</span><span id="c_nombre"></span></td>
            <td><span class="label"># DNI</span><span id="c_dni"></span></td>
        </tr>
        <tr>
            <td><span class="label">Estado civil</span><span id="c_civil"></span></td>
            <td><span class="label">Ciclo</span><span id="c_ciclo"></span></td>
            <td>
                <div style="display: flex; justify-content: space-between;">
                    <div><span class="label">Ocupación</span><span id="c_ocupacion"></span></div>
                    <div><span class="label">Edad</span><span id="c_edad"></span></div>
                </div>
            </td>
        </tr>
        <tr>
            <td><span class="label">Sexo</span><span id="c_sexo"></span></td>
            <td><span class="label">Celular</span><span id="c_cel"></span></td>
            <td><span class="label">Dependientes</span><span id="c_dependientes"></span></td>
        </tr>
        <tr>
            <td><span class="label">Monto solicitado</span><span id="c_monto"></span></td>
            <td><span class="label">Plazo solicitado</span><span id="c_plazo"></span></td>
            <td><span class="label">Producto</span><span id="c_producto"></span></td>
        </tr>
        <tr>
            <td><span class="label">Frecuencia</span><span id="c_frecuencia"></span></td>
            <td><span class="label">Cuota</span><span id="c_cuota"></span></td>
            <td><span class="label">Destino del préstamo</span><span id="c_destino"></span></td>
        </tr>
        <tr>
            <td><span class="label">Tipo de negocio</span><span id="c_tipo_negocio"></span></td>
            <td>
                <span class="label">Local del Negocio</span>
                <span class="check-box" id="c_local_pro"></span> Pro. 
                <span class="check-box" id="c_local_alq"></span> Alqui.
            </td>
            <td>
                <span class="label">Casa de habitación</span>
                <span class="check-box" id="c_casa_pro"></span> Pro. 
                <span class="check-box" id="c_casa_alq"></span> Alqui.
            </td>
        </tr>
        <tr>
            <td><span class="label">Nombre del negocio</span><span id="c_negocio_nombre"></span></td>
            <td><span class="label">Antigüedad del negocio</span><span id="c_negocio_antig"></span></td>
            <td><span class="label"># de empleados</span><span id="c_empleados"></span></td>
        </tr>
        <tr><td colspan="3"><span class="label">Dirección exacta del negocio con punto de referencia</span><span id="c_dir_negocio"></span></td></tr>
        <tr><td colspan="3"><span class="label">Dirección exacta del domicilio con punto de referencia</span><span id="c_dir_casa"></span></td></tr>
        <tr>
            <td colspan="2"><span class="label">Referencia personal y dirección</span><span id="c_ref_per"></span></td>
            <td><span class="label"># de teléfono</span><span id="c_ref_per_tel"></span></td>
        </tr>
        <tr>
            <td colspan="2"><span class="label">Referencia familiar y dirección</span><span id="c_ref_fam"></span></td>
            <td><span class="label"># de teléfono</span><span id="c_ref_fam_tel"></span></td>
        </tr>
    </table>

    <div class="section-title">ASALARIADOS</div>
    <table>
        <tr>
            <td><span class="label">Nombre de la empresa</span><span id="c_empresa_t"></span></td>
            <td><span class="label">Jefe inmediato</span><span id="c_jefe"></span></td>
            <td><span class="label">Teléfono</span><span id="c_tel_t"></span></td>
        </tr>
        <tr>
            <td><span class="label">Cargo</span><span id="c_cargo"></span></td>
            <td><span class="label">Antigüedad</span><span id="c_antig_lab"></span></td>
            <td><span class="label">Tipo de contrato</span><span id="c_contrato"></span></td>
        </tr>
    </table>

    <div class="section-title">INFORMACIÓN FINANCIERA</div>
    <table>
        <thead>
            <tr style="font-weight: bold; background: #f2f2f2;">
                <th style="width: 33%;">ACTIVOS</th>
                <th style="width: 33%;">INGRESOS</th>
                <th style="width: 34%;">EGRESOS</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td id="c_list_activos"></td>
                <td id="c_list_ingresos"></td>
                <td id="c_list_egresos"></td>
            </tr>
            <tr style="font-weight: bold;">
                <td>TOTAL: L. <span id="c_total_act"></span></td>
                <td>Total ingresos: L. <span id="c_total_ing"></span></td>
                <td>Total de gastos: L. <span id="c_total_egr"></span></td>
            </tr>
        </tbody>
    </table>
    <div style="border: 1px solid black; padding: 5px; text-align: right; font-weight: bold;">
        DISPONIBILIDAD: L. <span id="c_dispo"></span>
    </div>

    <div style="margin-top: 5px;">
        <span class="label">Análisis del asesor:</span>
        <div id="c_analisis" style="min-height: 40px; border: 1px solid black; padding: 3px;"></div>
    </div>

    <div class="footer-sig">
        <div><div class="sig-line"></div>Firma cliente</div>
        <div><div class="sig-line"></div>Firma, asesor de créditos</div>
        <div><div class="sig-line"></div>Firma, Autorizado SERFIN</div>
    </div>
</div>

<div class="page">
    <table class="no-border">
        <tr>
            <td class="no-border" style="width: 15%;"><img src="https://github.com/rimedhn/servicredith/blob/main/servicredith%20logo.jpeg?raw=true" class="mi-logo" /></td>
            <td class="no-border" style="text-align: center;">
                <h1 class="header-title">FICHA DE AVAL</h1>
                <div style="font-weight: bold; font-size: 14px;">SERFIN</div>
            </td>
            <td class="no-border" style="width: 15%; text-align: right;">
                <span class="label">Fecha:</span> <span id="fecha_p2"></span>
            </td>
        </tr>
    </table>

    <table>
        <tr>
            <td colspan="2"><span class="label">Nombre completo</span><span id="a_nombre"></span></td>
            <td><span class="label"># DNI</span><span id="a_dni"></span></td>
        </tr>
        <tr>
            <td><span class="label">Estado civil</span><span id="a_civil"></span></td>
            <td><span class="label">Ocupación</span><span id="a_ocupacion"></span></td>
            <td>
                <div style="display: flex; justify-content: space-between;">
                    <div><span class="label">Sexo</span><span id="a_sexo"></span></div>
                    <div><span class="label">Edad</span><span id="a_edad"></span></div>
                </div>
            </td>
        </tr>
        <tr>
            <td><span class="label">Celular</span><span id="a_cel"></span></td>
            <td><span class="label">Antigüedad del negocio</span><span id="a_negocio_antig"></span></td>
            <td><span class="label"># de empleados</span><span id="a_empleados"></span></td>
        </tr>
        <tr><td colspan="3"><span class="label">Dirección exacta del negocio</span><span id="a_dir_negocio"></span></td></tr>
        <tr><td colspan="3"><span class="label">Dirección exacta del domicilio</span><span id="a_dir_casa"></span></td></tr>
    </table>

    <div class="section-title">ASALARIADOS (AVAL)</div>
    <table>
        <tr>
            <td><span class="label">Nombre de la empresa</span><span id="a_empresa_t"></span></td>
            <td><span class="label">Jefe inmediato</span><span id="a_jefe"></span></td>
            <td><span class="label">Teléfono</span><span id="a_tel_t"></span></td>
        </tr>
    </table>

    <div class="section-title">INFORMACIÓN FINANCIERA (AVAL) [cite: 106-107]</div>
    <table>
        <thead>
            <tr style="font-weight: bold; background: #f2f2f2;">
                <th>ACTIVOS</th>
                <th>INGRESOS</th>
                <th>EGRESOS</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td id="a_list_activos"></td>
                <td id="a_list_ingresos"></td>
                <td id="a_list_egresos"></td>
            </tr>
            <tr style="font-weight: bold;">
                <td>TOTAL: L. <span id="a_total_act"></span></td>
                <td>Total ingresos: L. <span id="a_total_ing"></span></td>
                <td>Total de gastos: L. <span id="a_total_egr"></span></td>
            </tr>
        </tbody>
    </table>

    <div class="footer-sig" style="margin-top: 50px;">
        <div><div class="sig-line"></div>Firma de aval</div>
        <div><div class="sig-line"></div>Firma, asesor de créditos</div>
        <div><div class="sig-line"></div>Sello SERFIN</div>
    </div>
</div>

<script>
    function getQueryParam(param) {
        var urlParams = new URLSearchParams(window.location.search);
        return urlParams.get(param) || "";
    }

    function renderFinTable(containerId, namesStr, valuesStr) {
        if (!namesStr) return;
        const names = namesStr.split(",");
        const values = valuesStr.split(",");
        const container = document.getElementById(containerId);
        let html = "";
        names.forEach((n, i) => {
            html += `<div style="display:flex; justify-content:space-between; border-bottom:1px solid #eee; margin-bottom:2px;">
                        <span>${n.trim()}</span>
                        <span>L. ${values[i] ? values[i].trim() : "0.00"}</span>
                     </div>`;
        });
        container.innerHTML = html;
    }

    function fillData() {
        const fields = [
            "c_nombre", "c_dni", "c_civil", "c_ciclo", "c_ocupacion", "c_edad", "c_sexo", "c_cel",
            "c_dependientes", "c_monto", "c_plazo", "c_producto", "c_frecuencia", "c_cuota", "c_destino",
            "c_tipo_negocio", "c_negocio_nombre", "c_negocio_antig", "c_empleados", "c_dir_negocio", "c_dir_casa",
            "c_ref_per", "c_ref_per_tel", "c_ref_fam", "c_ref_fam_tel", "c_empresa_t", "c_jefe", "c_tel_t",
            "c_cargo", "c_antig_lab", "c_contrato", "c_total_act", "c_total_ing", "c_total_egr", "c_dispo", "c_analisis",
            "a_nombre", "a_dni", "a_civil", "a_ocupacion", "a_sexo", "a_edad", "a_cel", "a_negocio_antig", 
            "a_empleados", "a_dir_negocio", "a_dir_casa", "a_empresa_t", "a_jefe", "a_tel_t", "a_total_act", 
            "a_total_ing", "a_total_egr"
        ];

        fields.forEach(f => {
            const el = document.getElementById(f);
            if(el) el.textContent = getQueryParam(f);
        });

        // Manejo de Checkboxes (ej: ?c_local_pro=X)
        if(getQueryParam("c_local_pro")) document.getElementById("c_local_pro").textContent = "X";
        if(getQueryParam("c_local_alq")) document.getElementById("c_local_alq").textContent = "X";
        if(getQueryParam("c_casa_pro")) document.getElementById("c_casa_pro").textContent = "X";
        if(getQueryParam("c_casa_alq")) document.getElementById("c_casa_alq").textContent = "X";

        // Tablas Financieras Dinámicas
        renderFinTable("c_list_activos", getQueryParam("c_act_n"), getQueryParam("c_act_v"));
        renderFinTable("c_list_ingresos", getQueryParam("c_ing_n"), getQueryParam("c_ing_v"));
        renderFinTable("c_list_egresos", getQueryParam("c_egr_n"), getQueryParam("c_egr_v"));

        renderFinTable("a_list_activos", getQueryParam("a_act_n"), getQueryParam("a_act_v"));
        renderFinTable("a_list_ingresos", getQueryParam("a_ing_n"), getQueryParam("a_ing_v"));
        renderFinTable("a_list_egresos", getQueryParam("a_egr_n"), getQueryParam("a_egr_v"));

        const hoy = getQueryParam("fecha") || new Date().toLocaleDateString();
        document.getElementById("fecha_p1").textContent = hoy;
        document.getElementById("fecha_p2").textContent = hoy;
    }

    window.onload = fillData;
</script>
</body>
</html>
